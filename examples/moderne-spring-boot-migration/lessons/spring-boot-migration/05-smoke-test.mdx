---
title: Smoke Test
---
# Module 4: Raise Baseline and Smoke Test

In this module, you will raise the Java baseline to 17 and run a controlled Spring Boot 4 upgrade to identify any remaining blockers.

## Exercise 1: Upgrade to Java 17

Spring Boot 3+ (and 4) requires Java 17 or higher. So, let's upgrade all repositories to Java 17 first.

Run the `UpgradeToJava17` recipe:

```bash
mod run $WORKSPACE --recipe org.openrewrite.java.migrate.UpgradeToJava17
```

Apply the changes:

```bash
mod git apply $WORKSPACE --last-recipe-run
```

Now, build and commit the changes:

```bash
$WORKSHOP/build.sh
mod git add $WORKSPACE --last-recipe-run
mod git commit $WORKSPACE -m "Upgrade to Java 17" --last-recipe-run
```

And rebuild the LSTs:

```bash
mod build $WORKSPACE
```

## Exercise 2: Run a Spring Boot 4 Smoke Test

Now that we are on Java 17, let's see how far the Spring Boot 4 upgrade gets. This is a "smoke test" to identify remaining blockers.

Run the upgrade recipe:

```bash
mod run $WORKSPACE --recipe io.moderne.java.spring.boot4.UpgradeSpringBoot_4_0
```

Apply the changes temporarily:

```bash
mod git apply $WORKSPACE --last-recipe-run
```

## Exercise 3: Build Waves (Expect Failure)

Let's try to build Wave 0 and Wave 1.

```bash
$WORKSHOP/build.sh 0
```

Wave 0 (common libraries) should build successfully.

```bash
$WORKSHOP/build.sh 1
```

Wave 1 is expected to fail. Why? Because of QueryDSL issues! We'll fix this in the next module.

## Exercise 4: Restore Workspace

Since the build is broken, let's revert the changes.

```bash
mod exec $WORKSPACE git restore .
```

Verify the workspace is clean:

```bash
mod git status $WORKSPACE
```

Rebuild LSTs to ensure we are back to the Java 17 baseline:

```bash
mod build $WORKSPACE
```

---

**Quiz**

Why do we run a smoke test before the full migration?

1.  To see if the computer is smoking.
2.  To commit broken code.
3.  To isolate remaining obstacles (like QueryDSL) without committing to a full upgrade.
4.  To verify that Java 17 is installed correctly.

**Correct Answer**: 3
